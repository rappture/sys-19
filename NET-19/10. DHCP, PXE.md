# Домашнее задание к занятию «DHCP, PXE»
<br>

> ### Задание 1.
> Для чего служит протокол DHCP?  
> Может ли работать сеть без DHCP-сервера?  
> *Приведите ответ в свободной форме.*
>
### Ответ к заданию 1.
**D**ynamic **H**ost **C**onfiguration **P**rotocol (протокол динамической конфигурации узла) – сетевой протокол прикладного уровня модели TCP/IP позволяющий сетевым устройствам автоматически получать IP-адрес и другие параметры, необходимые для работы в сети.

Сеть может в полной мере работать без DHCP-сервера, однако его использование вносит вклад в автоматизацию процессов, упрощая добавление новых устройств в сеть.

---

> ### Задание 2.
> На каком порту/портах работает DHCP?  
> *Приведите ответ в свободной форме.*
>
### Ответ к заданию 2.
DHCP работает на портах 67 (server) и 68 (client).  
На этих же портах работает протокол BOOTP:

<kbd><img src="/img/net-10.2.1.png"></kbd>
 
---

> ### Задание 3.
> Какие настройки можно произвести используя опции?  
> Назовите 5.  
> *Приведите ответ в свободной форме.*
>
### Ответ к заданию 3.
Помимо IP-адреса, DHCP также может сообщать клиенту дополнительные параметры, необходимые для нормальной работы в сети. Эти параметры называются опциями DHCP.

Ниже 5 опций для примера.

| Код	| Название | Описание |
| :---: | :---: | :---: |
| 1 |	Subnet Mask	| Маска подсети, из которой получен адрес. |
| 3 |	Router	| Список IP-адресов шлюзов по умолчанию. |
| 6 |	Domain Name Server	|С писок IP-адресов серверов DNS. |
| 12 |	Host Name	| Имя хоста клиента. |
| 33	| Static Route	| Каждая пара адресов соответствует статическому маршруту. |

---

> ### Задание 4.
> Сконфигурируйте сервер DHCP.  
> *Пришлите получившийся конфигурационный файл.*
> 
### Ответ к заданию 4.
:large_blue_diamond:	Для чистоты эксперимента, подключаем по одному новому адаптеру к VM1 и VM2.

<kbd><img src="/img/net-10.4.1.png"></kbd>
 
<kbd><img src="/img/net-10.4.2.png"></kbd>
 
:large_blue_diamond:	Устанавливаем isc-dhcp-server на VM1:

<kbd><img src="/img/net-10.4.3.png"></kbd>
 
:large_blue_diamond:	Производим настройки на VM1:

<kbd><img src="/img/net-10.4.4.png"></kbd>
 
<kbd><img src="/img/net-10.4.5.png"></kbd>
 
<kbd><img src="/img/net-10.4.6.png"></kbd>
 
<kbd><img src="/img/net-10.4.7.png"></kbd>
 
:large_blue_diamond:	Поправляем настройки сетевых интерфейсов VM1:

<kbd><img src="/img/net-10.4.8.png"></kbd>
 
<kbd><img src="/img/net-10.4.9.png"></kbd>

:large_blue_diamond:	На VM1 перезапускаем сетевые службы, запускаем isc-dhcp-server и смотрим его статус:

<kbd><img src="/img/net-10.4.10.png"></kbd>
 
:large_blue_diamond:	Производим настройку интерфейсов VM2:

<kbd><img src="/img/net-10.4.11.png"></kbd>
 
<kbd><img src="/img/net-10.4.12.png"></kbd>
 
:large_blue_diamond:	На VM2 перезапускаем сетевые службы и проверяем результат с помощью команды `ip a`. Почему-то после первого перезапуска на интерфейсе enp0s8 вместе с данными, полученными по DHCP, оказалась лишняя информация (от отключенного интерфейса enp0s3 и какой-то IPv6 адрес). После повторного перезапуска данная проблема ушла:

<kbd><img src="/img/net-10.4.13.png"></kbd>
 
---

> ### Дополнительные задания (со звездочкой*)
> Эти задания дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.
>
> ### Задание 5.
> Поймайте в сети пакеты DHCP любым сниффером.  
> *Пришлите скриншот пойманого одного пакета с объяснением что это за пакет, какой шаг получения сетевых настроек.*
>
### Ответ к заданию 5.
На рисунке ниже DHCP пакет, отправленный сервером в адрес клиента.

В нем содержится DHCP ACK сообщение, которым сервер подтверждает направленный клиентом запрос (DHCP Request) на настройки, предложенные клиенту ранее (DHCP Offer).

Это завершающий этап получения сетевых настроек. Т.е. на этом обмен сообщениями закончен, и клиент должен применить полученные настройки.  

<kbd><img src="/img/net-10.5.1.png"></kbd>
 
---

> ### Задание 6.
> Сконфигурируйте сервер PXE, выложите любой образ.  
> *Пришлите скриншот клиента, который получил настройки и подключился к PXE-серверу.*
>
### Ответ к заданию 6.

:large_blue_diamond:	Устанавливаем HPA's tftp server на VM1:

<kbd><img src="/img/net-10.6.1.png"></kbd>
 
:large_blue_diamond:	Производим настройки на VM1:

<kbd><img src="/img/net-10.6.2.png"></kbd>
 
<kbd><img src="/img/net-10.6.3.png"></kbd>
 
:large_blue_diamond:	Перезапускаем службу и проверяем ее статус:

<kbd><img src="/img/net-10.6.4.png"></kbd>
 
:large_blue_diamond:	Устанавливаем Trivial file transfer protocol client на VM2:

<kbd><img src="/img/net-10.6.5.png"></kbd>
 
:large_blue_diamond:	Проверяем работоспособность:

<kbd><img src="/img/net-10.6.6.png"></kbd>
 
:large_blue_diamond:	Загружаем образ (например Debian), доступный для установки по сети, и распаковываем его в папку, настроенную ранее для HPA's tftp server:

<kbd><img src="/img/net-10.6.7.png"></kbd>
 
:large_blue_diamond:	Дополняем файл */etc/dhcp/dhcpd.conf* необходимыми параметрами и перезапускаем isc-dhcp-server:

<kbd><img src="/img/net-10.6.8.png"></kbd>
 
<kbd><img src="/img/net-10.6.9.png"></kbd>
 
<kbd><img src="/img/net-10.6.10.png"></kbd>
 
<kbd><img src="/img/net-10.6.11.png"></kbd>
 
:large_blue_diamond:	Меняем порядок загрузки для VM2, запускаем ее, получаем доступ к установке Debian по сети при помощи PXE:

<kbd><img src="/img/net-10.6.12.png"></kbd>
 
<kbd><img src="/img/net-10.6.13.png"></kbd>
 
<kbd><img src="/img/net-10.6.14.png"></kbd>
