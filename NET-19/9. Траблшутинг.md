# Домашнее задание к занятию «Траблшутинг»
<br>

> ### Задание 1.
> 1.	Укажите путь к файлам логов веб-сервера Nginx.
> 2.	Где находится конфигурационный файл, в котором можно посмотреть / поменять эти пути?
> 3.	Какой командой можно воспользоваться для просмотра файла журнала в режиме реального времени? Попробуйте найти сами, либо воспользуйтесь ссылкой.
>
> *Приведите ответ в свободной форме.*
>
### Ответ к заданию 1.
1.	Путь к файлам логов веб-сервера по умолчанию – `/usr/local/nginx/logs` или `/var/log/nginx.`
2.	По умолчанию, конфигурационный файл называется `nginx.conf` и расположен в каталоге `/usr/local/nginx/conf`, `/etc/nginx` или `/usr/local/etc/nginx`. 
3.	Команда `tail -f` , дополненная указанием нужного файла.

---

> ### Задание 2.
> Познакомьтесь со схемой сети.
>
> <kbd><img src="/img/net-9.2.1.png"></kbd>
>  
> 1.	*COMP1* не может обменяться данными с *COMP4*. Какую последовательность действий вы выберете для того, чтобы локализовать проблему?
> 2.	Возможно ли, чтобы при выполнении *ping 192.168.1.2* с компьютера *COMP5*, *ping* прошёл, а подключение по *HTTP* с *COMP5* на *COMP1* не проходило бы? Поясните свой ответ максимально детально.
> 3.	*COMP5* отправляет *ping* на *COMP1* и *COMP2*, при этом *COMP1* на *ping* отвечает, а *COMP2* - нет.
> Приведите максимальное количество причин. Самую простую, но нередко встречающуюся - «У *COMP2* выдернули кабель питания» - я уже ответил за вас.
> 4.	*COMP1* пингует только адреса из подсети *192.168.1.0/24* (*COMP2* и *192.168.1.1*), больше никакие адреса не пингуются. С чем это может быть связано?
>
> *Приведите ответ в свободной форме.*
>
### Ответ к заданию 2.
1.	На схеме, приведенной на рисунке, есть очевидная проблема: у COMP3 и COMP4 одинаковые ip-адреса. В итоге (если оба устройства включены) не понятно, какому из устройств направлять входящие пакеты.  
Если бы подсказки на схеме не было, то последовательность действий была бы такова:
    - 1.1.	Локализовать проблему:
      - a)	Проверить, доступны ли другие сервисы с *COMP1* и *COMP4*;
      - b)	Проверить, доступны ли *COMP1* и *COMP4* с других устройств;
      - c)	Если на шагах a) и b) ничего не было доступно, проверить, доступны ли различные сервисы на различных устройствах.
    - 1.2.	В зависимости от результатов на шаге 1.1., возможны различные варианты действий и их последовательность, но общая логика такова:
      - a)	Проверить включены ли оба устройства, подключены ли они к сети, исправны ли их кабели;
      - b)	Проверить настройку портов и наличие блокировок;
      - c)	Проверить ip-адреса, маршруты, шлюзы, возможные блокировки на стороне firewall-а;
      - d)	Проверить совместимость версий ПО, порты подключения;
      - e)	Проверить, не перегружен ли канал;
      - f)	Проверить, нет ли проблем на стороне провайдера.
2.	Поскольку ping выполняется по протоколу ICMP, а не HTTP, такая ситуация возможна. Причины могут быть различными:
    - 2.1.	На *COMP1* веб-сервер не поднят/упал;
    - 2.2.	На *COMP1* веб-сервер сконфигурирован неверно (например, слушает только localhost (127.0.0.1) или повешен не на тот порт);
    - 2.3.	Запросы http блокируются firewall-ом с той или иной стороны;
    - 2.4.	Где-то по пути настроена маршрутизация http запросов на другой адрес или на порт, который не прослушивается веб-сервером;
    - 2.5.	На одном или нескольких сетевых устройствах запрос блокируется посредством ACL (Access Control List).
    - 2.6.	Какой-то канал забит, и пакеты бОльшего размера, чем стандартный ICMP через него не пролезают;
    - 2.7.	и др.
3.	Помимо выдернутого у *COMP2* кабеля питания, возможны следующие причины:
    - 3.1.	В локации *COMP2* проблемы с электросетью (повреждена розетка, ИБП, сетевой фильтр или обесточен офис);
    - 3.2.	У *COMP2* кабель питания поврежден;
    - 3.3.	У *COMP2* выключен блок питания;
    - 3.4.	*COMP2* не запущен/в гибернации/спит;
    - 3.5.	На *COMP2* произошел аппаратный или/и программный сбой;
    - 3.6.	На *COMP2* отключен/неисправен сетевой кабель;
    - 3.7.	В ОС *COMP2* отключен доступ в сеть;
    - 3.8.	У *COMP2* не установлен сетевой адаптер или адаптер установлен, но отсутствует его драйвер;
    - 3.9.	Не верно настроен адаптер *COMP2* (указан не тот ip адрес, шлюз или/и пр.);
    - 3.10.	На свитче не настроен/заблокирован/сломан порт, к которому подключен *COMP2*;
    - 3.11.	Где-то по пути настроена некорректная маршрутизация/натирование запросов;
    - 3.12.	 Некорректная настройка VLAN;
    - 3.13.	Запросы/ответы блокируются firewall-ом той или иной стороны;
    - 3.14.	На одном или нескольких сетевых устройствах запрос блокируется посредством ACL (Access Control List).
    - 3.15.	 и др.
4.	Возможные проблемы:
    - 4.1.	У *COMP1* не настроен шлюз по умолчанию (default gateway);
    - 4.2.	Соответствующие настройки firewall-a;
    - 4.3.	Соответствующие настройки ACL на интерфейсе роутера;
    - 4.4.	и др.

---

> ### **
> ### Дополнительные задания (со звездочкой*)
> Эти задания дополнительные (не обязательные к выполнению) и никак не повлияют на получение вами зачета по этому домашнему заданию. Вы можете их выполнить, если хотите глубже и/или шире разобраться в материале.
> ### Задание 3.
> Используя схему из Задания 2, попробуйте ответить на вопросы:
> 1.	*COMP1* и *COMP2* оба пингуют *10.1.1.2*, однако не пингуют *192.168.2.1* и прочие адреса из *192.168.2.0/24*. Как вы думаете, что не так и как это можно исправить?
> 2.	Какими способами мы можем сделать так, чтобы *COMP2* не смог общаться ни с кем кроме своей локальной сети? (Приведите вариант с настройками самого *COMP2* и попробуйте придумать, можно ли что-то сделать на маршрутизаторе *192.168.1.1*)
> 3.	Как вы думаете, что будет происходить при попытке провести ping с *COMP5* на *192.168.2.3* ?
>
> *Приведите ответ в свободной форме.*
>
### Ответ к заданию 3.
1.	Устройства из сетей *192.168.1.0/24* и *10.1.1.0/30* не знают о существовании сети *192.168.2.0/24*. Можно или прописать маршруты на маршрутизаторах или настроить NAT.
2.	Варианты:
    - 2.1.	убрать в настройках *COMP2* шлюз по умолчанию;
    - 2.2.	настроить соответствующим образом firewall на *COMP2*;
    - 2.3.	установить соответствующий ACL на интерфейс роутера *192.168.1.1*.
3.	Адрес *192.168.2.3* указан как для *COMP3*, так и для *COMP4*. В результате если включено только одно устройство, ping будет проходить, а если оба – будет возникать конфликт и ping не пройдет.

---

> ### Задание 4.
> *	Сделайте ping с одной виртуальной / физической машины на другую.
> *	Используя [описание утилиты iperf](https://losst.pro/kak-polzovatsya-iperf), загрузите канал между двумя виртуальными машинами на максимум, например, на 60 секунд, в процессе загрузки повторите ping.
> *	Изменились ли цифры в ответе команды ping? Почему? Есть ли разница между физическими и виртуальными машинами?
>
> *Приведите скриншоты/ответы команд до и во время высокой загрузки каналов.*
>
### Ответ к заданию 4.
Практическая часть задания не выполнялась. Тем не менее, вне зависимости от того, физические машины или виртуальные, предположу, что при загруженном канале, ping действительно может возрастать, т.к. icmp пакетам сложно «протискиваться» между другими данными, курсирующими по сети, особенно если эти другие данные имеют более высокий приоритет.
