# Домашнее задание к занятию «Ansible. Часть 1»
<br>

> ### Задание 1
> Ответьте на вопрос в свободной форме.  
> Какие преимущества даёт подход IAC?
>
### Ответ к заданию 1
Исполнение одного и того же кода формирует одну и ту же исполняемую среду. Благодаря такому подходу достигается единообразие элементов инфраструктуры и их ожидаемое поведение, а также идемпотентность, как свойство системы принимать одно и то же состояние при одинаковых условиях вызова.

За счет того, что взаимодействие с инфраструктурой осуществляется не в ручном режиме, а через конфигурационные файлы, уменьшается вероятность ошибок, связанных с человеческим фактором.

За счет унификации конфигураций серверов решаются многие проблемы с их поддержкой и обслуживанием.

Способствует повышению скорости разработки, тестирования и возможности внедрения непрерывного развертывания (CI/CD). Достигается быстрая доставка и масштабирование приложений из тестовых сред в продакшн.

---

> ### Задание 2
> Выполните действия и приложите скриншоты действий.
> 1.	Установите Ansible.
> 2.	Настройте управляемые виртуальные машины, не меньше двух.
> 3.	Создайте файл inventory. Предлагается использовать файл, размещённый в папке с проектом, а не файл inventory по умолчанию.
> 4.	Проверьте доступность хостов с помощью модуля ping.
>
### Ответ к заданию 2
:large_blue_diamond:	В соответствии с документацией по установке Ansible, предварительно производим установку pip:

<kbd><img src="/img/cicd-1.2.1.png"></kbd>
 
<kbd><img src="/img/cicd-1.2.2.png"></kbd>
 
<kbd><img src="/img/cicd-1.2.3.png"></kbd>
 
:large_blue_diamond:	Устанавливаем Ansible с помощью pip, после установки проверяем версию:

<kbd><img src="/img/cicd-1.2.4.png"></kbd>
 
:large_blue_diamond:	Проверяем наличие ssh-сервера на управляемых узлах:

<kbd><img src="/img/cicd-1.2.5.png"></kbd>
 
:large_blue_diamond:	Генерируем и добавляем SSH-ключ на каждый управляемый узел:

<kbd><img src="/img/cicd-1.2.6.png"></kbd>
 
:large_blue_diamond:	Генерируем кофигурационный файл `ansible.cfg` в текущей директории, вносим в него будущее расположение inventory-файла `hosts`. Создаем файл `hosts`, вносим в него управляемые узлы, проверяем список узлов и их доступность: 

<kbd><img src="/img/cicd-1.2.7.png"></kbd>
 
<kbd><img src="/img/cicd-1.2.8.png"></kbd>

---

> ### Задание 3
> Ответьте на вопрос в свободной форме.  
> Какая разница между параметрами forks и serial?
>
### Ответ к заданию 3.
:large_blue_diamond: **Forks** определяет количество управляемых узлов на которых параллельно (одновременно) выполняется задача.

Предположим, что у нас в playbook-е 2 задачи, в inventory 10 нод, а forks = 5; время выполнения каждой задачи составляет 5 секунд:
*	Первая задача выполнится одновременно на 5 нодах (node1, node2, node3, node4, node5), после чего первая задача выполнится одновременно на оставшихся 5 нодах (node6, node7, node8, node9, node10).
*	Далее вторая задача выполнится одновременно на 5 нодах (node1, node2, node3, node4, node5), после чего вторая задача выполнится одновременно на оставшихся 5 нодах (node6, node7, node8, node9, node10).
*	Время, затраченное на 1-ю задачу = 5 сек. (5 нод) + 5 сек. (5 нод).
*	Время, затраченное на 2-ю задачу = 5 сек. (5 нод) + 5 сек. (5 нод).
*	Общее время на выполнение всего playbook = 20 сек.

:large_blue_diamond: **Serial** определяет на скольких управляемых узлах за раз playbook должен выполниться полностью.

Предположим, что у нас в playbook-е 2 задачи, в inventory 10 нод, forks = 5, а serial = 4; время выполнения каждой задачи составляет 5 секунд:
*	Первый проход, 1-ая задача = 5 сек (node1, node2, node3, node4).
*	Первый проход, 2-ая задача = 5сек (node1, node2, node3, node4).
*	Второй проход, 1-ая задача = 5 сек (node5, node6, node7, node8).
*	Второй проход, 2-ая задача = 5 сек (node5, node6, node7, node8).
*	Третий проход, 1-ая задача = 5 сек (node9, node10).
*	Третий проход, 2-ая задача = 5 сек (node9, node10).
*	Общее время на выполнение всего playbook = 30 сек.

---

> ### Задание 4
> В этом задании вы будете работать с Ad-hoc коммандами.  
> Выполните действия и приложите скриншоты запуска команд.
> 1.	Установите на управляемых хостах любой пакет, которого нет.
> 2.	Проверьте статус любого, присутствующего на управляемой машине, сервиса.
> 3.	Создайте файл с содержимым «I like Linux» по пути /tmp/netology.txt.
>
### Ответ к заданию 4
1.	`ansible myvirtualmachines -m apt -a "name=tree state=present" --become -K`

<kbd><img src="/img/cicd-1.4.1.png"></kbd>
 
2.	Не нашла встроенных специализированных модулей, идеально подходящих под данный пункт задания. Найденные варианты:
    *	с помощью модуля shell (`ansible all -m shell -a "systemctl status apache2"`);
    *	c помощью модуля service (`ansible myvirtualmachines -m service -a "name=apache2 state=stopped"`), но он не проверяет статус сервиса, а пытается изменить его состояние;
    *	c помощью модуля service_facts (`ansible all -m service_facts`), но не обнаружила в нем возможности фильтрации по определенному сервису через Ad-hoc команду.

<kbd><img src="/img/cicd-1.4.2.png"></kbd>
 
3.	`ansible myvirtualmachines -m lineinfile -a "line='I like Linux' path=/tmp/netology.txt create=true"`

<kbd><img src="/img/cicd-1.4.3.png"></kbd>
